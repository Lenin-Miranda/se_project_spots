!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input-error"},n=(e,t,n)=>{console.log("Input ID:",t.id);const r=e.querySelector(`#${t.id}-error`);t.classList.remove(n.inputErrorClass),r.textContent=""},r=(e,t,n)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,n):(t.disabled=!1,t.classList.remove(n.inactiveButtonClass))};function o(e,t){e.disabled=!0,e.classList.add(t.inactiveButtonClass)}const a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);r(o,a,t),o.forEach((d=>{d.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?n(e,t,r):((e,t,n,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.add(r.inputErrorClass),o.textContent=n})(e,t,t.validationMessage,r)})(e,d,t),r(o,a,t)}))}))})(t,e)}))};a(t);var d=e+"d3610e9c6dce3cb370d8.svg",c=e+"d38272e02bb4f1ab1c37.svg",l=e+"40608da7369d39bc1077.svg",s=e+"dba18798529f242c4c6d.svg",i=e+"53f0bab7ec2e970778f9.svg",u=e+"d73f076c46eb5467f5fc.svg";document.getElementById("profile__avatar-logo").src=u,document.getElementById("close__icon-avatar").src=s;const m=document.getElementById("profile__avatar");document.getElementById("header__logo").src=d,document.getElementById("profile__logo").src=c,document.getElementById("profile__logo-plus").src=l,document.getElementById("close__icon").src=s,document.getElementById("close__icon-cards").src=s,document.getElementById("close__icon-preview").src=i,document.getElementById("close__icon-delete").src=i;const _=document.querySelector("#media-template"),h=document.querySelectorAll(".modal"),v=document.querySelector("#modal-edit"),f=document.querySelector(".modal__input_type_description"),p=document.querySelector("#modal-edit-delete"),y=document.getElementById("form-delete"),b=document.querySelector(".modal__input_type_name"),S=document.forms["profile-form"],E=document.querySelector("#modal-edit-card"),g=document.querySelector("#form-card"),q=document.querySelector("#modal__preview"),C=(document.querySelector(".modal__close-btn_type_preview"),document.querySelector("#form-avatar")),k=document.querySelector(".modal__image"),L=document.querySelector(".modal__caption"),x=document.querySelector(".profile__edit-btn"),I=document.querySelector(".profile__username"),B=document.querySelector(".profile__description"),U=document.querySelector(".profile__avatar"),$=document.querySelector(".profile__container-avatar"),A=document.querySelector("#modal-edit-avatar"),D=document.querySelector(".profile__avatar-btn"),R=document.querySelector("#add-avatar-link-input"),T=document.querySelector(".modal__button"),w=document.querySelector("#add-card-link-input"),P=document.querySelector(".media__cards"),N=document.querySelector("#add-card-caption-input"),O=document.querySelector(".profile__buttom");let j=null,F=null,J=null;const H=document.querySelector(".modal__button-delete"),z=document.querySelector(".modal__button-cancel"),M=document.querySelector(".modal__button-avatar"),G=new class{constructor(e){this.options=e,this.baseUrl=e.baseUrl,this.headers=e.headers}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._handleResponse)}addLikedCard(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._handleResponse)}removeLikeCard(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._handleResponse)}updateAvatar(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._handleResponse)}updateUserInfo(e){let{name:t,about:n}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:n})}).then(this._handleResponse)}loadingCards(e){let{name:t,link:n}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:n})}).then(this._handleResponse)}removeCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._handleResponse)}getAllData(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"c8225591-fba4-4b45-b151-2e1ffac6d30d","Content-Type":"application/json"}});function K(e){const t=_.content.querySelector(".card").cloneNode(!0),n=t.querySelector(".card__description"),r=t.querySelector(".card__like-btn"),o=t.querySelector(".card__image"),a=t.querySelector(".card__delete-btn");return n.textContent=e.name,o.src=e.link,o.alt=e.name,r.addEventListener("click",(()=>{r.classList.contains("card__like-btn_liked")?G.removeLikeCard(e._id).then((()=>{r.classList.remove("card__like-btn_liked")})).catch((e=>{console.error("failed to remove like:",e)})):G.addLikedCard(e._id).then((()=>{r.classList.add("card__like-btn_liked")})).catch((e=>{console.error("failed to add like:",e)})),r.classList.toggle("card__like-btn_liked")})),a.addEventListener("click",(()=>{j=t,F=e._id,V(p)})),o.addEventListener("click",(()=>{k.src=e.link,k.alt=e.name,L.textContent=e.name,V(q)})),t}function Q(e){if(e.preventDefault(),!F||!j)return;const t=H.textContent;H.textContent="Deleting...",G.removeCard(F).then((()=>{j&&(H.textContent=t,j.remove()),j=null,F=null})).catch((e=>{console.error("Failed to delete card:",e)})).finally((()=>{setTimeout((()=>{W(p)}),100)}))}function V(e){e.classList.add("modal_opened"),document.addEventListener("keydown",Y)}function W(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",Y)}G.getInitialCards().then((e=>{e.forEach((e=>{const t=K(e);P.prepend(t)}))})).catch((e=>{console.error(e)})),G.getAllData().then((e=>{let[t,n]=e;J=n._id,I.textContent=n.name,B.textContent=n.about,m.src=n.avatar,m.alt=n.name})).catch((e=>{console.error(e)})),$.addEventListener("mouseenter",(()=>{D.classList.add("profile_avatar-index")})),$.addEventListener("mouseleave",(()=>{D.classList.remove("profile_avatar-index")})),D.addEventListener("click",(()=>{V(A)})),M.addEventListener("click",(function(e){e.preventDefault();const n=M.textContent;M.textContent="Saving...",G.updateAvatar(R.value).then((e=>{o(M,t),U.src=e.avatar,U.alt=e.name,W(A)})).catch((e=>{console.error("Error updating avatar:",e)})).finally((()=>{C.reset(),M.textContent=n}))}));const X=document.querySelector(".modal__button-profile");function Y(e){"Escape"===e.key&&W(document.querySelector(".modal_opened"))}h.forEach((e=>{e.addEventListener("click",(t=>{t.target===e&&W(e)}))})),document.querySelectorAll(".modal__close-btn").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>W(t)))})),x.addEventListener("click",(()=>{var e,r,a;b.value=I.textContent,f.value=B.textContent,e=S,r=T,a=t,[b,f].forEach((t=>{n(e,t,a)})),o(r,a),V(v)})),y.addEventListener("submit",Q),S.addEventListener("submit",(function(e){e.preventDefault();const t=T.textContent;X.textContent="Saving...";const n=b.value,r=f.value;G.updateUserInfo({name:n,about:r}).then((e=>{I.textContent=e.name,B.textContent=e.about,X.textContent=t})).catch((e=>{console.error("Failed to update user info:",e)})).finally((()=>{setTimeout((()=>{W(v)}),100)}))})),g.addEventListener("submit",(function(e){e.preventDefault();const n=N.value,r=w.value,a=e.submitter.textContent;e.submitter.textContent="Saving...",G.loadingCards({name:n,link:r}).then((n=>{const r=K(n);P.prepend(r),o(e.submitter,t),g.reset()})).catch((e=>{console.error("Failed to load card:",e)})).finally((()=>{e.submitter.textContent=a,W(E)}))})),O.addEventListener("click",(()=>{V(E)})),z.addEventListener("click",(()=>W(p))),p.addEventListener("submit",Q),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eUIsVUFBV3BLLEdBRTdCNEQsRUFBZStGLE9BQU8sSUFFdkJ0QixPQUFPQyxJQUNONUgsUUFBUTZILE1BQU0sdUJBQXdCRCxFQUFJLElBRTNDUSxTQUFRLEtBQ1BILEVBQUl5QixVQUFVbkosWUFBYzRILEVBQzVCRyxFQUFXckYsRUFBYyxHQUUvQixJQW9EQWtCLEVBQW9CMUMsaUJBQWlCLFNBQVMsS0FDNUNzRyxFQUFVOUUsRUFBYyxJQUUxQnVCLEVBQXFCL0MsaUJBQWlCLFNBQVMsSUFBTTZHLEVBQVcxRixLQUVoRUEsRUFBWW5CLGlCQUFpQixTQUFVdUcsR0FFdkM5RyxFQUFpQjVCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvQVBJLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvclwiLFxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JFbCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yRWwudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc29sZS5sb2coXCJJbnB1dCBJRDpcIiwgaW5wdXRFbGVtZW50LmlkKTtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xufTtcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykge1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn1cblxuY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xuICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIGNvbmZpZ1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcbiAgfSk7XG59O1xuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG5cbmV4cG9ydCB7IGRpc2FibGVCdXR0b24sIHJlc2V0VmFsaWRhdGlvbiwgc2V0dGluZ3MsIGVuYWJsZVZhbGlkYXRpb24gfTtcbiIsImltcG9ydCB7IGRpc2FibGVCdXR0b24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCB7IHJlc2V0VmFsaWRhdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IGF2YXRhclNyYyBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcbmltcG9ydCBoZWFkZXJMb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvc3BvdHMuc3ZnXCI7XG5pbXBvcnQgcHJvZmlsZUxvZ29TcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwuc3ZnXCI7XG5pbXBvcnQgcHJvZmlsZUxvZ29QbHVzU3JjIGZyb20gXCIuLi9pbWFnZXMvUGx1cy5zdmdcIjtcbmltcG9ydCBjbG9zZUljb25TcmMgZnJvbSBcIi4uL2ltYWdlcy9CbGFja1guc3ZnXCI7XG5pbXBvcnQgY2xvc2VJY29uUHJldmlld1NyYyBmcm9tIFwiLi4vaW1hZ2VzL0Nsb3NlLWljb24td2hpdGUuc3ZnXCI7XG5pbXBvcnQgd2hpdGVQZW5jaWxTcmMgZnJvbSBcIi4uL2ltYWdlcy93aGl0ZVBlbmNpbC5zdmdcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3NjcmlwdHMvQVBJLmpzXCI7XG5cbmNvbnN0IHByb2ZpbGVBdmF0YXJCdG5Mb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlX19hdmF0YXItbG9nb1wiKTtcbnByb2ZpbGVBdmF0YXJCdG5Mb2dvLnNyYyA9IHdoaXRlUGVuY2lsU3JjO1xuXG5jb25zdCBwcm9maWxlQXZhdGFyQnRuQ2xvc2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlX19pY29uLWF2YXRhclwiKTtcbnByb2ZpbGVBdmF0YXJCdG5DbG9zZS5zcmMgPSBjbG9zZUljb25TcmM7XG5cbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVfX2F2YXRhclwiKTtcblxuY29uc3QgaGVhZGVyTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVhZGVyX19sb2dvXCIpO1xuaGVhZGVyTG9nby5zcmMgPSBoZWFkZXJMb2dvU3JjO1xuXG5jb25zdCBwcm9maWxlTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZV9fbG9nb1wiKTtcbnByb2ZpbGVMb2dvLnNyYyA9IHByb2ZpbGVMb2dvU3JjO1xuXG5jb25zdCBwcm9maWxlTG9nb1BsdXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVfX2xvZ28tcGx1c1wiKTtcbnByb2ZpbGVMb2dvUGx1cy5zcmMgPSBwcm9maWxlTG9nb1BsdXNTcmM7XG5cbmNvbnN0IGNsb3NlSWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb25cIik7XG5jbG9zZUljb24uc3JjID0gY2xvc2VJY29uU3JjO1xuXG5jb25zdCBjbG9zZUljb25jYXJkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb24tY2FyZHNcIik7XG5jbG9zZUljb25jYXJkcy5zcmMgPSBjbG9zZUljb25TcmM7XG5cbmNvbnN0IGNsb3NlSWNvblByZXZpZXcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlX19pY29uLXByZXZpZXdcIik7XG5jbG9zZUljb25QcmV2aWV3LnNyYyA9IGNsb3NlSWNvblByZXZpZXdTcmM7XG5cbmNvbnN0IGNsb3NlSWNvbkRlbGV0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb24tZGVsZXRlXCIpO1xuY2xvc2VJY29uRGVsZXRlLnNyYyA9IGNsb3NlSWNvblByZXZpZXdTcmM7XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiVmFsIHRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5dO1xuXG4vL0dFVFxuXG4vLyBUZW1wbGF0ZVxuY29uc3QgY2FyZHNUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbWVkaWEtdGVtcGxhdGVcIik7XG5cbi8vIE1vZGFsXG5jb25zdCBhbGxNb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xuY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0XCIpO1xuY29uc3QgZGVzY3JpcHRpb25UZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfZGVzY3JpcHRpb25cIlxuKTtcbmNvbnN0IG1vZGFsRGVsZXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0LWRlbGV0ZVwiKTtcbmNvbnN0IGZvcm1EZWxldGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvcm0tZGVsZXRlXCIpO1xuXG5jb25zdCBuYW1lVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XG5jb25zdCBtb2RhbEFkZENhcmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0LWNhcmRcIik7XG5jb25zdCBtb2RhbENhcmRzRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1jYXJkXCIpO1xuY29uc3QgbW9kYWxQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9fcHJldmlld1wiKTtcbmNvbnN0IG1vZGFsQ2FyZENsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ0bl90eXBlX3ByZXZpZXdcIlxuKTtcbmNvbnN0IG1vZGFsQXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1hdmF0YXJcIik7XG5jb25zdCBtb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBtb2RhbENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vL3Byb2ZpbGVcbmNvbnN0IHByb2ZpbGVPcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX191c2VybmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlQXZhdGFyTG9nbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhckxvZ29Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19jb250YWluZXItYXZhdGFyXCJcbik7XG5jb25zdCBwcm9maWxlQXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWVkaXQtYXZhdGFyXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWF2YXRhci1saW5rLWlucHV0XCIpO1xuXG4vLyBDYXJkc1xuXG5jb25zdCBjYXJkU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuY29uc3QgbGlua1RleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWxpbmstaW5wdXRcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lZGlhX19jYXJkc1wiKTtcbmNvbnN0IGNhcHRpb25UZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1jYXB0aW9uLWlucHV0XCIpO1xuY29uc3QgY2FyZE1vZGFsT3BlbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9tXCIpO1xubGV0IHNlbGVjdGVkQ2FyZCA9IG51bGw7XG5sZXQgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xubGV0IGN1cnJlbnRVc2VySWQgPSBudWxsO1xuLy9idXR0b25cbmNvbnN0IG1vZGFsRGVsZXRlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uLWRlbGV0ZVwiKTtcbmNvbnN0IG1vZGFsRGVsZXRlQ2FuY2VsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uLWNhbmNlbFwiKTtcbmNvbnN0IG1vZGFsQXZhdGFyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uLWF2YXRhclwiKTtcblxuLy8gQXBpXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJjODIyNTU5MS1mYmE0LTRiNDUtYjE1MS0yZTFmZmFjNmQzMGRcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChyZXMpID0+IHtcbiAgICByZXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgY2FyZHNFbGVtZW50ID0gZ2V0Q2FyZHNFbGVtZW50KGl0ZW0pO1xuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZHNFbGVtZW50KTtcbiAgICB9KTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gIH0pO1xuXG5hcGlcbiAgLmdldEFsbERhdGEoKVxuICAudGhlbigoW2NhcmRzRGF0YSwgdXNlcnNEYXRhXSkgPT4ge1xuICAgIGN1cnJlbnRVc2VySWQgPSB1c2Vyc0RhdGEuX2lkO1xuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlcnNEYXRhLm5hbWU7XG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlcnNEYXRhLmFib3V0O1xuICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gdXNlcnNEYXRhLmF2YXRhcjtcbiAgICBwcm9maWxlQXZhdGFyLmFsdCA9IHVzZXJzRGF0YS5uYW1lO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgfSk7XG5cbi8vIEdldCBDYXJkc1xuZnVuY3Rpb24gZ2V0Q2FyZHNFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZHNFbGVtZW50ID0gY2FyZHNUZW1wbGF0ZS5jb250ZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgY29uc3QgY2FyZHNOYW1lID0gY2FyZHNFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVzY3JpcHRpb25cIik7XG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gY2FyZHNFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNvbnN0IGNhcmRzSW1hZ2UgPSBjYXJkc0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRzRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XG5cbiAgY2FyZHNOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkc0ltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgY2FyZHNJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XG5cbiAgLy9jYXJkIGxpa2VcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjb25zdCBpc0xpa2VkID0gY2FyZExpa2VCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gICAgaWYgKGlzTGlrZWQpIHtcbiAgICAgIGFwaVxuICAgICAgICAucmVtb3ZlTGlrZUNhcmQoZGF0YS5faWQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcImZhaWxlZCB0byByZW1vdmUgbGlrZTpcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFwaVxuICAgICAgICAuYWRkTGlrZWRDYXJkKGRhdGEuX2lkKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJmYWlsZWQgdG8gYWRkIGxpa2U6XCIsIGVycik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gIH0pO1xuXG4gIC8vY2FyZCBkZWxldGVcbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHNlbGVjdGVkQ2FyZCA9IGNhcmRzRWxlbWVudDtcbiAgICBzZWxlY3RlZENhcmRJZCA9IGRhdGEuX2lkO1xuICAgIG9wZW5Nb2RhbChtb2RhbERlbGV0ZSk7XG4gIH0pO1xuXG4gIC8vY2FyZCBwcmV2aWV3XG4gIGNhcmRzSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBtb2RhbEltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICBtb2RhbEltYWdlLmFsdCA9IGRhdGEubmFtZTtcbiAgICBtb2RhbENhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgb3Blbk1vZGFsKG1vZGFsUHJldmlldyk7XG4gIH0pO1xuXG4gIHJldHVybiBjYXJkc0VsZW1lbnQ7XG59XG5cbi8vTW9kYWwgYXZhdGFyXG5wcm9maWxlQXZhdGFyTG9nb0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoKSA9PiB7XG4gIHByb2ZpbGVBdmF0YXJCdG4uY2xhc3NMaXN0LmFkZChcInByb2ZpbGVfYXZhdGFyLWluZGV4XCIpO1xufSk7XG5cbnByb2ZpbGVBdmF0YXJMb2dvQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsICgpID0+IHtcbiAgcHJvZmlsZUF2YXRhckJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwicHJvZmlsZV9hdmF0YXItaW5kZXhcIik7XG59KTtcblxucHJvZmlsZUF2YXRhckJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwocHJvZmlsZUF2YXRhck1vZGFsKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IG9yaWdpbmFsVGV4dCA9IG1vZGFsQXZhdGFyQnRuLnRleHRDb250ZW50O1xuICBtb2RhbEF2YXRhckJ0bi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG5cbiAgYXBpXG4gICAgLnVwZGF0ZUF2YXRhcihwcm9maWxlQXZhdGFySW5wdXQudmFsdWUpXG4gICAgLnRoZW4oKHVwZGF0ZWRVc2VyKSA9PiB7XG4gICAgICBkaXNhYmxlQnV0dG9uKG1vZGFsQXZhdGFyQnRuLCBzZXR0aW5ncyk7XG4gICAgICBwcm9maWxlQXZhdGFyTG9nby5zcmMgPSB1cGRhdGVkVXNlci5hdmF0YXI7XG4gICAgICBwcm9maWxlQXZhdGFyTG9nby5hbHQgPSB1cGRhdGVkVXNlci5uYW1lO1xuXG4gICAgICBjbG9zZVBvcHVwKHByb2ZpbGVBdmF0YXJNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIGF2YXRhcjpcIiwgZXJyKTtcbiAgICAgIC8vIFB1ZWRlcyBtb3N0cmFyIHVuIG1lbnNhamUgZGUgZXJyb3IgZW4gbGEgVUkgc2kgbG8gZGVzZWFzXG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBtb2RhbEF2YXRhckZvcm0ucmVzZXQoKTtcbiAgICAgIG1vZGFsQXZhdGFyQnRuLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0O1xuICAgIH0pO1xufVxubW9kYWxBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgaWYgKCFzZWxlY3RlZENhcmRJZCB8fCAhc2VsZWN0ZWRDYXJkKSByZXR1cm47XG5cbiAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gbW9kYWxEZWxldGVCdG4udGV4dENvbnRlbnQ7XG4gIG1vZGFsRGVsZXRlQnRuLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xuXG4gIGFwaVxuICAgIC5yZW1vdmVDYXJkKHNlbGVjdGVkQ2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGlmIChzZWxlY3RlZENhcmQpIHtcbiAgICAgICAgbW9kYWxEZWxldGVCdG4udGV4dENvbnRlbnQgPSBvcmlnaW5hbFRleHQ7XG4gICAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcbiAgICAgIH1cbiAgICAgIHNlbGVjdGVkQ2FyZCA9IG51bGw7XG4gICAgICBzZWxlY3RlZENhcmRJZCA9IG51bGw7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBkZWxldGUgY2FyZDpcIiwgZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjbG9zZVBvcHVwKG1vZGFsRGVsZXRlKTtcbiAgICAgIH0sIDEwMCk7XG4gICAgfSk7XG59XG5cbi8vIE9wZW4gTW9kYWxcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBtb2RhbENsb3NlT25Fc2MpO1xufVxuXG4vLyBDbG9zZSBNb2RhbFxuXG5mdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwKSB7XG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIG1vZGFsQ2xvc2VPbkVzYyk7XG59XG5cbmNvbnN0IG1vZGFsU3VibWl0QnRuUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvbi1wcm9maWxlXCIpO1xuXG4vLyBQcm9maWxlIEZvcm0gU3VibWl0XG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IG9yaWdpbmFsVGV4dCA9IGNhcmRTdWJtaXRCdG4udGV4dENvbnRlbnQ7XG4gIG1vZGFsU3VibWl0QnRuUHJvZmlsZS50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gIGNvbnN0IG5hbWUgPSBuYW1lVGV4dC52YWx1ZTtcbiAgY29uc3QgYWJvdXQgPSBkZXNjcmlwdGlvblRleHQudmFsdWU7XG5cbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSlcbiAgICAudGhlbigodXBkYXRlZFVzZXIpID0+IHtcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXBkYXRlZFVzZXIubmFtZTtcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVwZGF0ZWRVc2VyLmFib3V0O1xuICAgICAgbW9kYWxTdWJtaXRCdG5Qcm9maWxlLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0O1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gdXBkYXRlIHVzZXIgaW5mbzpcIiwgZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjbG9zZVBvcHVwKHByb2ZpbGVNb2RhbCk7XG4gICAgICB9LCAxMDApO1xuICAgIH0pO1xufVxuXG4vLyBDYXJkIEZvcm0gU3VibWl0XG5mdW5jdGlvbiBoYW5kbGVyQ2FyZEZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBuYW1lID0gY2FwdGlvblRleHQudmFsdWU7XG4gIGNvbnN0IGxpbmsgPSBsaW5rVGV4dC52YWx1ZTtcbiAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gZXZ0LnN1Ym1pdHRlci50ZXh0Q29udGVudDtcbiAgZXZ0LnN1Ym1pdHRlci50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG5cbiAgYXBpXG4gICAgLmxvYWRpbmdDYXJkcyh7IG5hbWUsIGxpbmsgfSlcbiAgICAudGhlbigobmV3Q2FyZCkgPT4ge1xuICAgICAgY29uc3QgY2FyZHNFbGVtZW50ID0gZ2V0Q2FyZHNFbGVtZW50KG5ld0NhcmQpO1xuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZHNFbGVtZW50KTtcblxuICAgICAgZGlzYWJsZUJ1dHRvbihldnQuc3VibWl0dGVyLCBzZXR0aW5ncyk7XG5cbiAgICAgIG1vZGFsQ2FyZHNGb3JtLnJlc2V0KCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBsb2FkIGNhcmQ6XCIsIGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBldnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0O1xuICAgICAgY2xvc2VQb3B1cChtb2RhbEFkZENhcmRzKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGNsb3NlUG9wdXBPdXRzaWRlKG1vZGFscykge1xuICBtb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+IHtcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSBtb2RhbCkge1xuICAgICAgICBjbG9zZVBvcHVwKG1vZGFsKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5jbG9zZVBvcHVwT3V0c2lkZShhbGxNb2RhbHMpO1xuXG4vL0ZvciBFYWNoIGNhcmRzXG5cbi8vIENsb3NlIE1vZGFsXG5cbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcblxuY2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICAvLyBGaW5kIHRoZSBjbG9zZXN0IHBvcHVwIG9ubHkgb25jZVxuICBjb25zdCBwb3B1cCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xuICAvLyBTZXQgdGhlIGxpc3RlbmVyXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VQb3B1cChwb3B1cCkpO1xufSk7XG5cbi8va2V5UHJlc3NcbmZ1bmN0aW9uIG1vZGFsQ2xvc2VPbkVzYyhldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuZWRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIGNsb3NlUG9wdXAob3BlbmVkUG9wdXApO1xuICB9XG59XG4vLyBPcGVuIE1vZGFsXG5wcm9maWxlT3BlbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBuYW1lVGV4dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBkZXNjcmlwdGlvblRleHQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XG4gIHJlc2V0VmFsaWRhdGlvbihcbiAgICBwcm9maWxlRm9ybSxcbiAgICBbbmFtZVRleHQsIGRlc2NyaXB0aW9uVGV4dF0sXG4gICAgY2FyZFN1Ym1pdEJ0bixcbiAgICBzZXR0aW5nc1xuICApO1xuICBvcGVuTW9kYWwocHJvZmlsZU1vZGFsKTtcbn0pO1xuLy8gRm9ybSBkZWxldGVcbmZvcm1EZWxldGUuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuLy8gUHJvZmlsZSBmb3JtIFN1Ym1pdFxucHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XG5cbi8vIENhcmQgRm9ybSBzdWJtaXRcbm1vZGFsQ2FyZHNGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlckNhcmRGb3JtU3VibWl0KTtcblxuY2FyZE1vZGFsT3BlbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwobW9kYWxBZGRDYXJkcyk7XG59KTtcbm1vZGFsRGVsZXRlQ2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZVBvcHVwKG1vZGFsRGVsZXRlKSk7XG5cbm1vZGFsRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICB9XG5cbiAgX2hhbmRsZVJlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkTGlrZWRDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIHJlbW92ZUxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZUF2YXRhcihhdmF0YXIpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGFib3V0OiBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xuICB9XG5cbiAgbG9hZGluZ0NhcmRzKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cblxuICByZW1vdmVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIGdldEFsbERhdGEoKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBcGk7XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJjb25maWciLCJjb25zb2xlIiwibG9nIiwiaWQiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsImVuYWJsZVZhbGlkYXRpb24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJnZXRFbGVtZW50QnlJZCIsInNyYyIsIndoaXRlUGVuY2lsU3JjIiwiY2xvc2VJY29uU3JjIiwicHJvZmlsZUF2YXRhciIsImhlYWRlckxvZ29TcmMiLCJwcm9maWxlTG9nb1NyYyIsInByb2ZpbGVMb2dvUGx1c1NyYyIsImNsb3NlSWNvblByZXZpZXdTcmMiLCJjYXJkc1RlbXBsYXRlIiwiYWxsTW9kYWxzIiwicHJvZmlsZU1vZGFsIiwiZGVzY3JpcHRpb25UZXh0IiwibW9kYWxEZWxldGUiLCJmb3JtRGVsZXRlIiwibmFtZVRleHQiLCJwcm9maWxlRm9ybSIsImZvcm1zIiwibW9kYWxBZGRDYXJkcyIsIm1vZGFsQ2FyZHNGb3JtIiwibW9kYWxQcmV2aWV3IiwibW9kYWxBdmF0YXJGb3JtIiwibW9kYWxJbWFnZSIsIm1vZGFsQ2FwdGlvbiIsInByb2ZpbGVPcGVuQnV0dG9uIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyTG9nbyIsInByb2ZpbGVBdmF0YXJMb2dvQ29udGFpbmVyIiwicHJvZmlsZUF2YXRhck1vZGFsIiwicHJvZmlsZUF2YXRhckJ0biIsInByb2ZpbGVBdmF0YXJJbnB1dCIsImNhcmRTdWJtaXRCdG4iLCJsaW5rVGV4dCIsImNhcmRzTGlzdCIsImNhcHRpb25UZXh0IiwiY2FyZE1vZGFsT3BlbkJ1dHRvbiIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwiY3VycmVudFVzZXJJZCIsIm1vZGFsRGVsZXRlQnRuIiwibW9kYWxEZWxldGVDYW5jZWxCdG4iLCJtb2RhbEF2YXRhckJ0biIsImFwaSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInRoaXMiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9oYW5kbGVSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJhZGRMaWtlZENhcmQiLCJjYXJkSWQiLCJtZXRob2QiLCJyZW1vdmVMaWtlQ2FyZCIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VXNlckluZm8iLCJ1cGRhdGVVc2VySW5mbyIsIl9yZWYiLCJuYW1lIiwiYWJvdXQiLCJsb2FkaW5nQ2FyZHMiLCJfcmVmMiIsImxpbmsiLCJyZW1vdmVDYXJkIiwiZ2V0QWxsRGF0YSIsImFsbCIsImF1dGhvcml6YXRpb24iLCJnZXRDYXJkc0VsZW1lbnQiLCJkYXRhIiwiY2FyZHNFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRzTmFtZSIsImNhcmRMaWtlQnRuIiwiY2FyZHNJbWFnZSIsImNhcmREZWxldGVCdG4iLCJhbHQiLCJjb250YWlucyIsIl9pZCIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJ0b2dnbGUiLCJvcGVuTW9kYWwiLCJoYW5kbGVEZWxldGVTdWJtaXQiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIm9yaWdpbmFsVGV4dCIsImZpbmFsbHkiLCJzZXRUaW1lb3V0IiwiY2xvc2VQb3B1cCIsIm1vZGFsIiwibW9kYWxDbG9zZU9uRXNjIiwicG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaXRlbSIsInByZXBlbmQiLCJjYXJkc0RhdGEiLCJ1c2Vyc0RhdGEiLCJ2YWx1ZSIsInVwZGF0ZWRVc2VyIiwicmVzZXQiLCJtb2RhbFN1Ym1pdEJ0blByb2ZpbGUiLCJrZXkiLCJldmVudCIsInRhcmdldCIsImJ1dHRvbiIsImNsb3Nlc3QiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dCIsInN1Ym1pdHRlciIsIm5ld0NhcmQiXSwic291cmNlUm9vdCI6IiJ9