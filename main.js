!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input-error"},n=(e,t,n)=>{console.log("Input ID:",t.id);const r=e.querySelector(`#${t.id}-error`);t.classList.remove(n.inputErrorClass),r.textContent=""},r=(e,t,n)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,n):(t.disabled=!1,t.classList.remove(n.inactiveButtonClass))};function o(e,t){e.disabled=!0,e.classList.add(t.inactiveButtonClass)}const a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);r(o,a,t),o.forEach((d=>{d.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?n(e,t,r):((e,t,n,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.add(r.inputErrorClass),o.textContent=n})(e,t,t.validationMessage,r)})(e,d,t),r(o,a,t)}))}))})(t,e)}))};a(t);var d=e+"d3610e9c6dce3cb370d8.svg",c=e+"d38272e02bb4f1ab1c37.svg",l=e+"40608da7369d39bc1077.svg",s=e+"dba18798529f242c4c6d.svg",i=e+"53f0bab7ec2e970778f9.svg",u=e+"d73f076c46eb5467f5fc.svg";document.getElementById("profile__avatar-logo").src=u,document.getElementById("close__icon-avatar").src=s;const m=document.getElementById("profile__avatar");document.getElementById("header__logo").src=d,document.getElementById("profile__logo").src=c,document.getElementById("profile__logo-plus").src=l,document.getElementById("close__icon").src=s,document.getElementById("close__icon-cards").src=s,document.getElementById("close__icon-preview").src=i,document.getElementById("close__icon-delete").src=i;const _=document.querySelector("#media-template"),h=document.querySelectorAll(".modal"),v=document.querySelector("#modal-edit"),f=document.querySelector(".modal__input_type_description"),p=document.querySelector("#modal-edit-delete"),y=document.getElementById("form-delete"),b=document.querySelector(".modal__input_type_name"),S=document.forms["profile-form"],E=document.querySelector("#modal-edit-card"),g=document.querySelector("#form-card"),q=document.querySelector("#modal__preview"),C=(document.querySelector(".modal__close-btn_type_preview"),document.querySelector("#form-avatar")),k=document.querySelector(".modal__image"),L=document.querySelector(".modal__caption"),x=document.querySelector(".profile__edit-btn"),I=document.querySelector(".profile__username"),B=document.querySelector(".profile__description"),U=document.querySelector(".profile__avatar"),$=document.querySelector(".profile__container-avatar"),A=document.querySelector("#modal-edit-avatar"),D=document.querySelector(".profile__avatar-btn"),R=document.querySelector("#add-avatar-link-input"),T=document.querySelector(".modal__button"),w=document.querySelector("#add-card-link-input"),P=document.querySelector(".media__cards"),N=document.querySelector("#add-card-caption-input"),O=document.querySelector(".profile__buttom");let j=null,F=null,J=null;const H=document.querySelector(".modal__button-delete"),z=document.querySelector(".modal__button-cancel"),M=document.querySelector(".modal__button-avatar"),G=new class{constructor(e){this.options=e,this.baseUrl=e.baseUrl,this.headers=e.headers}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._handleResponse)}addLikedCard(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._handleResponse)}removeLikeCard(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._handleResponse)}updateAvatar(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._handleResponse)}updateUserInfo(e){let{name:t,about:n}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:n})}).then(this._handleResponse)}loadingCards(e){let{name:t,link:n}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:n})}).then(this._handleResponse)}removeCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._handleResponse)}getAllData(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"c8225591-fba4-4b45-b151-2e1ffac6d30d","Content-Type":"application/json"}});function K(e){const t=_.content.querySelector(".card").cloneNode(!0),n=t.querySelector(".card__description"),r=t.querySelector(".card__like-btn"),o=t.querySelector(".card__image"),a=t.querySelector(".card__delete-btn");return n.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked&&r.classList.add("card__like-btn_liked"),r.addEventListener("click",(()=>{r.classList.contains("card__like-btn_liked")?G.removeLikeCard(e._id).then((()=>{r.classList.remove("card__like-btn_liked")})).catch((e=>{console.error("failed to remove like:",e)})):G.addLikedCard(e._id).then((()=>{r.classList.add("card__like-btn_liked")})).catch((e=>{console.error("failed to add like:",e)}))})),a.addEventListener("click",(()=>{j=t,F=e._id,V(p)})),o.addEventListener("click",(()=>{k.src=e.link,k.alt=e.name,L.textContent=e.name,V(q)})),t}function Q(e){if(e.preventDefault(),!F||!j)return;const t=H.textContent;H.textContent="Deleting...",G.removeCard(F).then((()=>{j&&(H.textContent=t,W(p),j.remove()),j=null,F=null})).catch((e=>{console.error("Failed to delete card:",e)}))}function V(e){e.classList.add("modal_opened"),document.addEventListener("keydown",Y)}function W(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",Y)}G.getAllData().then((e=>{let[t,n]=e;J=n._id,I.textContent=n.name,B.textContent=n.about,m.src=n.avatar,m.alt=n.name,t.forEach((e=>{const t=K(e);P.prepend(t)}))})).catch((e=>{console.error(e)})),$.addEventListener("mouseenter",(()=>{D.classList.add("profile_avatar-index")})),$.addEventListener("mouseleave",(()=>{D.classList.remove("profile_avatar-index")})),D.addEventListener("click",(()=>{V(A)})),M.addEventListener("click",(function(e){e.preventDefault();const n=M.textContent;M.textContent="Saving...",G.updateAvatar(R.value).then((e=>{o(M,t),U.src=e.avatar,U.alt=e.name,C.reset(),W(A)})).catch((e=>{console.error("Error updating avatar:",e)})).finally((()=>{M.textContent=n}))}));const X=document.querySelector(".modal__button-profile");function Y(e){"Escape"===e.key&&W(document.querySelector(".modal_opened"))}h.forEach((e=>{e.addEventListener("click",(t=>{t.target===e&&W(e)}))})),document.querySelectorAll(".modal__close-btn").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>W(t)))})),x.addEventListener("click",(()=>{var e,r,a;b.value=I.textContent,f.value=B.textContent,e=S,r=T,a=t,[b,f].forEach((t=>{n(e,t,a)})),o(r,a),V(v)})),y.addEventListener("submit",Q),S.addEventListener("submit",(function(e){e.preventDefault();const t=T.textContent;X.textContent="Saving...";const n=b.value,r=f.value;G.updateUserInfo({name:n,about:r}).then((e=>{I.textContent=e.name,B.textContent=e.about,X.textContent=t})).catch((e=>{console.error("Failed to update user info:",e)})).finally((()=>{setTimeout((()=>{W(v)}),100)}))})),g.addEventListener("submit",(function(e){e.preventDefault();const n=N.value,r=w.value,a=e.submitter.textContent;e.submitter.textContent="Saving...",G.loadingCards({name:n,link:r}).then((n=>{const r=K(n);P.prepend(r),o(e.submitter,t),g.reset()})).catch((e=>{console.error("Failed to load card:",e)})).finally((()=>{e.submitter.textContent=a,W(E)}))})),O.addEventListener("click",(()=>{V(E)})),z.addEventListener("click",(()=>W(p))),p.addEventListener("submit",Q),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBSXlCLFVBQVVuSixZQUFjNEgsRUFDNUJDLEVBQVduRixFQUFjLEdBRS9CLElBb0RBa0IsRUFBb0IxQyxpQkFBaUIsU0FBUyxLQUM1Q3NHLEVBQVU5RSxFQUFjLElBRTFCdUIsRUFBcUIvQyxpQkFBaUIsU0FBUyxJQUFNMkcsRUFBV3hGLEtBRWhFQSxFQUFZbkIsaUJBQWlCLFNBQVV1RyxHQUV2QzlHLEVBQWlCNUIsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy9BUEkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvckVsID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zb2xlLmxvZyhcIklucHV0IElEOlwiLCBpbnB1dEVsZW1lbnQuaWQpO1xuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG5cbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG59O1xuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICB9KTtcbn07XG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKSB7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufVxuXG5jb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcbiAgfSk7XG4gIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihcbiAgICAgIGZvcm1FbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxuICAgICAgY29uZmlnXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICB9XG59O1xuXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcbiAgKTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn07XG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcblxuZXhwb3J0IHsgZGlzYWJsZUJ1dHRvbiwgcmVzZXRWYWxpZGF0aW9uLCBzZXR0aW5ncywgZW5hYmxlVmFsaWRhdGlvbiB9O1xuIiwiaW1wb3J0IHsgZGlzYWJsZUJ1dHRvbiB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuaW1wb3J0IHsgcmVzZXRWYWxpZGF0aW9uIH0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuaW1wb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmltcG9ydCBoZWFkZXJMb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvc3BvdHMuc3ZnXCI7XG5pbXBvcnQgcHJvZmlsZUxvZ29TcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwuc3ZnXCI7XG5pbXBvcnQgcHJvZmlsZUxvZ29QbHVzU3JjIGZyb20gXCIuLi9pbWFnZXMvUGx1cy5zdmdcIjtcbmltcG9ydCBjbG9zZUljb25TcmMgZnJvbSBcIi4uL2ltYWdlcy9CbGFja1guc3ZnXCI7XG5pbXBvcnQgY2xvc2VJY29uUHJldmlld1NyYyBmcm9tIFwiLi4vaW1hZ2VzL0Nsb3NlLWljb24td2hpdGUuc3ZnXCI7XG5pbXBvcnQgd2hpdGVQZW5jaWxTcmMgZnJvbSBcIi4uL2ltYWdlcy93aGl0ZVBlbmNpbC5zdmdcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3NjcmlwdHMvQVBJLmpzXCI7XG5cbmNvbnN0IHByb2ZpbGVBdmF0YXJCdG5Mb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlX19hdmF0YXItbG9nb1wiKTtcbnByb2ZpbGVBdmF0YXJCdG5Mb2dvLnNyYyA9IHdoaXRlUGVuY2lsU3JjO1xuXG5jb25zdCBwcm9maWxlQXZhdGFyQnRuQ2xvc2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlX19pY29uLWF2YXRhclwiKTtcbnByb2ZpbGVBdmF0YXJCdG5DbG9zZS5zcmMgPSBjbG9zZUljb25TcmM7XG5cbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVfX2F2YXRhclwiKTtcblxuY29uc3QgaGVhZGVyTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVhZGVyX19sb2dvXCIpO1xuaGVhZGVyTG9nby5zcmMgPSBoZWFkZXJMb2dvU3JjO1xuXG5jb25zdCBwcm9maWxlTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZV9fbG9nb1wiKTtcbnByb2ZpbGVMb2dvLnNyYyA9IHByb2ZpbGVMb2dvU3JjO1xuXG5jb25zdCBwcm9maWxlTG9nb1BsdXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVfX2xvZ28tcGx1c1wiKTtcbnByb2ZpbGVMb2dvUGx1cy5zcmMgPSBwcm9maWxlTG9nb1BsdXNTcmM7XG5cbmNvbnN0IGNsb3NlSWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb25cIik7XG5jbG9zZUljb24uc3JjID0gY2xvc2VJY29uU3JjO1xuXG5jb25zdCBjbG9zZUljb25jYXJkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb24tY2FyZHNcIik7XG5jbG9zZUljb25jYXJkcy5zcmMgPSBjbG9zZUljb25TcmM7XG5cbmNvbnN0IGNsb3NlSWNvblByZXZpZXcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlX19pY29uLXByZXZpZXdcIik7XG5jbG9zZUljb25QcmV2aWV3LnNyYyA9IGNsb3NlSWNvblByZXZpZXdTcmM7XG5cbmNvbnN0IGNsb3NlSWNvbkRlbGV0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb24tZGVsZXRlXCIpO1xuY2xvc2VJY29uRGVsZXRlLnNyYyA9IGNsb3NlSWNvblByZXZpZXdTcmM7XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiVmFsIHRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5dO1xuXG4vL0dFVFxuXG4vLyBUZW1wbGF0ZVxuY29uc3QgY2FyZHNUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbWVkaWEtdGVtcGxhdGVcIik7XG5cbi8vIE1vZGFsXG5jb25zdCBhbGxNb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xuY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0XCIpO1xuY29uc3QgZGVzY3JpcHRpb25UZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfZGVzY3JpcHRpb25cIlxuKTtcbmNvbnN0IG1vZGFsRGVsZXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0LWRlbGV0ZVwiKTtcbmNvbnN0IGZvcm1EZWxldGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvcm0tZGVsZXRlXCIpO1xuXG5jb25zdCBuYW1lVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XG5jb25zdCBtb2RhbEFkZENhcmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0LWNhcmRcIik7XG5jb25zdCBtb2RhbENhcmRzRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1jYXJkXCIpO1xuY29uc3QgbW9kYWxQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9fcHJldmlld1wiKTtcbmNvbnN0IG1vZGFsQ2FyZENsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ0bl90eXBlX3ByZXZpZXdcIlxuKTtcbmNvbnN0IG1vZGFsQXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1hdmF0YXJcIik7XG5jb25zdCBtb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBtb2RhbENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vL3Byb2ZpbGVcbmNvbnN0IHByb2ZpbGVPcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX191c2VybmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlQXZhdGFyTG9nbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhckxvZ29Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19jb250YWluZXItYXZhdGFyXCJcbik7XG5jb25zdCBwcm9maWxlQXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWVkaXQtYXZhdGFyXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWF2YXRhci1saW5rLWlucHV0XCIpO1xuXG4vLyBDYXJkc1xuXG5jb25zdCBjYXJkU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuY29uc3QgbGlua1RleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWxpbmstaW5wdXRcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lZGlhX19jYXJkc1wiKTtcbmNvbnN0IGNhcHRpb25UZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1jYXB0aW9uLWlucHV0XCIpO1xuY29uc3QgY2FyZE1vZGFsT3BlbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9tXCIpO1xubGV0IHNlbGVjdGVkQ2FyZCA9IG51bGw7XG5sZXQgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xubGV0IGN1cnJlbnRVc2VySWQgPSBudWxsO1xuXG4vL2J1dHRvblxuY29uc3QgbW9kYWxEZWxldGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b24tZGVsZXRlXCIpO1xuY29uc3QgbW9kYWxEZWxldGVDYW5jZWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b24tY2FuY2VsXCIpO1xuY29uc3QgbW9kYWxBdmF0YXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b24tYXZhdGFyXCIpO1xuXG4vLyBBcGlcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImM4MjI1NTkxLWZiYTQtNGI0NS1iMTUxLTJlMWZmYWM2ZDMwZFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmFwaVxuICAuZ2V0QWxsRGF0YSgpXG4gIC50aGVuKChbY2FyZHNEYXRhLCB1c2Vyc0RhdGFdKSA9PiB7XG4gICAgY3VycmVudFVzZXJJZCA9IHVzZXJzRGF0YS5faWQ7XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2Vyc0RhdGEubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2Vyc0RhdGEuYWJvdXQ7XG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSB1c2Vyc0RhdGEuYXZhdGFyO1xuICAgIHByb2ZpbGVBdmF0YXIuYWx0ID0gdXNlcnNEYXRhLm5hbWU7XG5cbiAgICBjYXJkc0RhdGEuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgY2FyZHNFbGVtZW50ID0gZ2V0Q2FyZHNFbGVtZW50KGl0ZW0pO1xuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZHNFbGVtZW50KTtcbiAgICB9KTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gIH0pO1xuXG4vLyBHZXQgQ2FyZHNcbmZ1bmN0aW9uIGdldENhcmRzRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRzRWxlbWVudCA9IGNhcmRzVGVtcGxhdGUuY29udGVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gIGNvbnN0IGNhcmRzTmFtZSA9IGNhcmRzRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2Rlc2NyaXB0aW9uXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRzRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xuICBjb25zdCBjYXJkc0ltYWdlID0gY2FyZHNFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdG4gPSBjYXJkc0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xuXG4gIGNhcmRzTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgY2FyZHNJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRzSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gIH1cbiAgLy9jYXJkIGxpa2VcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjb25zdCBpc0xpa2VkID0gY2FyZExpa2VCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gICAgaWYgKGlzTGlrZWQpIHtcbiAgICAgIGFwaVxuICAgICAgICAucmVtb3ZlTGlrZUNhcmQoZGF0YS5faWQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcImZhaWxlZCB0byByZW1vdmUgbGlrZTpcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFwaVxuICAgICAgICAuYWRkTGlrZWRDYXJkKGRhdGEuX2lkKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJmYWlsZWQgdG8gYWRkIGxpa2U6XCIsIGVycik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgLy9jYXJkIGRlbGV0ZVxuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgc2VsZWN0ZWRDYXJkID0gY2FyZHNFbGVtZW50O1xuICAgIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XG4gICAgb3Blbk1vZGFsKG1vZGFsRGVsZXRlKTtcbiAgfSk7XG5cbiAgLy9jYXJkIHByZXZpZXdcbiAgY2FyZHNJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIG1vZGFsSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIG1vZGFsSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIG1vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBvcGVuTW9kYWwobW9kYWxQcmV2aWV3KTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRzRWxlbWVudDtcbn1cblxuLy9Nb2RhbCBhdmF0YXJcbnByb2ZpbGVBdmF0YXJMb2dvQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsICgpID0+IHtcbiAgcHJvZmlsZUF2YXRhckJ0bi5jbGFzc0xpc3QuYWRkKFwicHJvZmlsZV9hdmF0YXItaW5kZXhcIik7XG59KTtcblxucHJvZmlsZUF2YXRhckxvZ29Db250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKCkgPT4ge1xuICBwcm9maWxlQXZhdGFyQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJwcm9maWxlX2F2YXRhci1pbmRleFwiKTtcbn0pO1xuXG5wcm9maWxlQXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChwcm9maWxlQXZhdGFyTW9kYWwpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gbW9kYWxBdmF0YXJCdG4udGV4dENvbnRlbnQ7XG4gIG1vZGFsQXZhdGFyQnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcblxuICBhcGlcbiAgICAudXBkYXRlQXZhdGFyKHByb2ZpbGVBdmF0YXJJbnB1dC52YWx1ZSlcbiAgICAudGhlbigodXBkYXRlZFVzZXIpID0+IHtcbiAgICAgIGRpc2FibGVCdXR0b24obW9kYWxBdmF0YXJCdG4sIHNldHRpbmdzKTtcbiAgICAgIHByb2ZpbGVBdmF0YXJMb2dvLnNyYyA9IHVwZGF0ZWRVc2VyLmF2YXRhcjtcbiAgICAgIHByb2ZpbGVBdmF0YXJMb2dvLmFsdCA9IHVwZGF0ZWRVc2VyLm5hbWU7XG4gICAgICBtb2RhbEF2YXRhckZvcm0ucmVzZXQoKTtcbiAgICAgIGNsb3NlUG9wdXAocHJvZmlsZUF2YXRhck1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgYXZhdGFyOlwiLCBlcnIpO1xuICAgICAgLy8gUHVlZGVzIG1vc3RyYXIgdW4gbWVuc2FqZSBkZSBlcnJvciBlbiBsYSBVSSBzaSBsbyBkZXNlYXNcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIG1vZGFsQXZhdGFyQnRuLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0O1xuICAgIH0pO1xufVxubW9kYWxBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgaWYgKCFzZWxlY3RlZENhcmRJZCB8fCAhc2VsZWN0ZWRDYXJkKSByZXR1cm47XG5cbiAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gbW9kYWxEZWxldGVCdG4udGV4dENvbnRlbnQ7XG4gIG1vZGFsRGVsZXRlQnRuLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xuXG4gIGFwaVxuICAgIC5yZW1vdmVDYXJkKHNlbGVjdGVkQ2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGlmIChzZWxlY3RlZENhcmQpIHtcbiAgICAgICAgbW9kYWxEZWxldGVCdG4udGV4dENvbnRlbnQgPSBvcmlnaW5hbFRleHQ7XG5cbiAgICAgICAgY2xvc2VQb3B1cChtb2RhbERlbGV0ZSk7XG5cbiAgICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgc2VsZWN0ZWRDYXJkID0gbnVsbDtcbiAgICAgIHNlbGVjdGVkQ2FyZElkID0gbnVsbDtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGRlbGV0ZSBjYXJkOlwiLCBlcnIpO1xuICAgIH0pO1xufVxuXG4vLyBPcGVuIE1vZGFsXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgbW9kYWxDbG9zZU9uRXNjKTtcbn1cblxuLy8gQ2xvc2UgTW9kYWxcblxuZnVuY3Rpb24gY2xvc2VQb3B1cChwb3B1cCkge1xuICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBtb2RhbENsb3NlT25Fc2MpO1xufVxuXG5jb25zdCBtb2RhbFN1Ym1pdEJ0blByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b24tcHJvZmlsZVwiKTtcblxuLy8gUHJvZmlsZSBGb3JtIFN1Ym1pdFxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBvcmlnaW5hbFRleHQgPSBjYXJkU3VibWl0QnRuLnRleHRDb250ZW50O1xuICBtb2RhbFN1Ym1pdEJ0blByb2ZpbGUudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICBjb25zdCBuYW1lID0gbmFtZVRleHQudmFsdWU7XG4gIGNvbnN0IGFib3V0ID0gZGVzY3JpcHRpb25UZXh0LnZhbHVlO1xuXG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pXG4gICAgLnRoZW4oKHVwZGF0ZWRVc2VyKSA9PiB7XG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVwZGF0ZWRVc2VyLm5hbWU7XG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1cGRhdGVkVXNlci5hYm91dDtcbiAgICAgIG1vZGFsU3VibWl0QnRuUHJvZmlsZS50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHVwZGF0ZSB1c2VyIGluZm86XCIsIGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY2xvc2VQb3B1cChwcm9maWxlTW9kYWwpO1xuICAgICAgfSwgMTAwKTtcbiAgICB9KTtcbn1cblxuLy8gQ2FyZCBGb3JtIFN1Ym1pdFxuZnVuY3Rpb24gaGFuZGxlckNhcmRGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgbmFtZSA9IGNhcHRpb25UZXh0LnZhbHVlO1xuICBjb25zdCBsaW5rID0gbGlua1RleHQudmFsdWU7XG4gIGNvbnN0IG9yaWdpbmFsVGV4dCA9IGV2dC5zdWJtaXR0ZXIudGV4dENvbnRlbnQ7XG4gIGV2dC5zdWJtaXR0ZXIudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuXG4gIGFwaVxuICAgIC5sb2FkaW5nQ2FyZHMoeyBuYW1lLCBsaW5rIH0pXG4gICAgLnRoZW4oKG5ld0NhcmQpID0+IHtcbiAgICAgIGNvbnN0IGNhcmRzRWxlbWVudCA9IGdldENhcmRzRWxlbWVudChuZXdDYXJkKTtcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRzRWxlbWVudCk7XG5cbiAgICAgIGRpc2FibGVCdXR0b24oZXZ0LnN1Ym1pdHRlciwgc2V0dGluZ3MpO1xuXG4gICAgICBtb2RhbENhcmRzRm9ybS5yZXNldCgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBjYXJkOlwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZXZ0LnN1Ym1pdHRlci50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcbiAgICAgIGNsb3NlUG9wdXAobW9kYWxBZGRDYXJkcyk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBjbG9zZVBvcHVwT3V0c2lkZShtb2RhbHMpIHtcbiAgbW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XG4gICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gbW9kYWwpIHtcbiAgICAgICAgY2xvc2VQb3B1cChtb2RhbCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuY2xvc2VQb3B1cE91dHNpZGUoYWxsTW9kYWxzKTtcblxuLy9Gb3IgRWFjaCBjYXJkc1xuXG4vLyBDbG9zZSBNb2RhbFxuXG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5cbmNsb3NlQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgLy8gRmluZCB0aGUgY2xvc2VzdCBwb3B1cCBvbmx5IG9uY2VcbiAgY29uc3QgcG9wdXAgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcbiAgLy8gU2V0IHRoZSBsaXN0ZW5lclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlUG9wdXAocG9wdXApKTtcbn0pO1xuXG4vL2tleVByZXNzXG5mdW5jdGlvbiBtb2RhbENsb3NlT25Fc2MoZXZ0KSB7XG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgY29uc3Qgb3BlbmVkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcbiAgICBjbG9zZVBvcHVwKG9wZW5lZFBvcHVwKTtcbiAgfVxufVxuLy8gT3BlbiBNb2RhbFxucHJvZmlsZU9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgbmFtZVRleHQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgZGVzY3JpcHRpb25UZXh0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24oXG4gICAgcHJvZmlsZUZvcm0sXG4gICAgW25hbWVUZXh0LCBkZXNjcmlwdGlvblRleHRdLFxuICAgIGNhcmRTdWJtaXRCdG4sXG4gICAgc2V0dGluZ3NcbiAgKTtcbiAgb3Blbk1vZGFsKHByb2ZpbGVNb2RhbCk7XG59KTtcbi8vIEZvcm0gZGVsZXRlXG5mb3JtRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcbi8vIFByb2ZpbGUgZm9ybSBTdWJtaXRcbnByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xuXG4vLyBDYXJkIEZvcm0gc3VibWl0XG5tb2RhbENhcmRzRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZXJDYXJkRm9ybVN1Ym1pdCk7XG5cbmNhcmRNb2RhbE9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKG1vZGFsQWRkQ2FyZHMpO1xufSk7XG5tb2RhbERlbGV0ZUNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VQb3B1cChtb2RhbERlbGV0ZSkpO1xuXG5tb2RhbERlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgdGhpcy5iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH1cbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZExpa2VkQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cblxuICByZW1vdmVMaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVBdmF0YXIoYXZhdGFyKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIGxvYWRpbmdDYXJkcyh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgbGluazogbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cblxuICBnZXRBbGxEYXRhKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpO1xuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiY29uc29sZSIsImxvZyIsImlkIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRleHRDb250ZW50IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJhZGQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInNldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZ2V0RWxlbWVudEJ5SWQiLCJzcmMiLCJ3aGl0ZVBlbmNpbFNyYyIsImNsb3NlSWNvblNyYyIsInByb2ZpbGVBdmF0YXIiLCJoZWFkZXJMb2dvU3JjIiwicHJvZmlsZUxvZ29TcmMiLCJwcm9maWxlTG9nb1BsdXNTcmMiLCJjbG9zZUljb25QcmV2aWV3U3JjIiwiY2FyZHNUZW1wbGF0ZSIsImFsbE1vZGFscyIsInByb2ZpbGVNb2RhbCIsImRlc2NyaXB0aW9uVGV4dCIsIm1vZGFsRGVsZXRlIiwiZm9ybURlbGV0ZSIsIm5hbWVUZXh0IiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsIm1vZGFsQWRkQ2FyZHMiLCJtb2RhbENhcmRzRm9ybSIsIm1vZGFsUHJldmlldyIsIm1vZGFsQXZhdGFyRm9ybSIsIm1vZGFsSW1hZ2UiLCJtb2RhbENhcHRpb24iLCJwcm9maWxlT3BlbkJ1dHRvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhckxvZ28iLCJwcm9maWxlQXZhdGFyTG9nb0NvbnRhaW5lciIsInByb2ZpbGVBdmF0YXJNb2RhbCIsInByb2ZpbGVBdmF0YXJCdG4iLCJwcm9maWxlQXZhdGFySW5wdXQiLCJjYXJkU3VibWl0QnRuIiwibGlua1RleHQiLCJjYXJkc0xpc3QiLCJjYXB0aW9uVGV4dCIsImNhcmRNb2RhbE9wZW5CdXR0b24iLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImN1cnJlbnRVc2VySWQiLCJtb2RhbERlbGV0ZUJ0biIsIm1vZGFsRGVsZXRlQ2FuY2VsQnRuIiwibW9kYWxBdmF0YXJCdG4iLCJhcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiYWRkTGlrZWRDYXJkIiwiY2FyZElkIiwibWV0aG9kIiwicmVtb3ZlTGlrZUNhcmQiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXIiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFVzZXJJbmZvIiwidXBkYXRlVXNlckluZm8iLCJfcmVmIiwibmFtZSIsImFib3V0IiwibG9hZGluZ0NhcmRzIiwiX3JlZjIiLCJsaW5rIiwicmVtb3ZlQ2FyZCIsImdldEFsbERhdGEiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwiZ2V0Q2FyZHNFbGVtZW50IiwiZGF0YSIsImNhcmRzRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkc05hbWUiLCJjYXJkTGlrZUJ0biIsImNhcmRzSW1hZ2UiLCJjYXJkRGVsZXRlQnRuIiwiYWx0IiwiaXNMaWtlZCIsImNvbnRhaW5zIiwiX2lkIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsIm9wZW5Nb2RhbCIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwib3JpZ2luYWxUZXh0IiwiY2xvc2VQb3B1cCIsIm1vZGFsIiwibW9kYWxDbG9zZU9uRXNjIiwicG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY2FyZHNEYXRhIiwidXNlcnNEYXRhIiwiaXRlbSIsInByZXBlbmQiLCJ2YWx1ZSIsInVwZGF0ZWRVc2VyIiwicmVzZXQiLCJmaW5hbGx5IiwibW9kYWxTdWJtaXRCdG5Qcm9maWxlIiwia2V5IiwiZXZlbnQiLCJ0YXJnZXQiLCJidXR0b24iLCJjbG9zZXN0IiwicmVzZXRWYWxpZGF0aW9uIiwiaW5wdXQiLCJzZXRUaW1lb3V0Iiwic3VibWl0dGVyIiwibmV3Q2FyZCJdLCJzb3VyY2VSb290IjoiIn0=