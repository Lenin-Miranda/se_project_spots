!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input-error"},n=(e,t,n)=>{console.log("Input ID:",t.id);const r=e.querySelector(`#${t.id}-error`);t.classList.remove(n.inputErrorClass),r.textContent=""},r=(e,t,n)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,n):(t.disabled=!1,t.classList.remove(n.inactiveButtonClass))};function o(e,t){e.disabled=!0,e.classList.add(t.inactiveButtonClass)}const a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);r(o,a,t),o.forEach((d=>{d.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?n(e,t,r):((e,t,n,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.add(r.inputErrorClass),o.textContent=n})(e,t,t.validationMessage,r)})(e,d,t),r(o,a,t)}))}))})(t,e)}))};a(t);var d=e+"d3610e9c6dce3cb370d8.svg",c=e+"d38272e02bb4f1ab1c37.svg",l=e+"40608da7369d39bc1077.svg",s=e+"dba18798529f242c4c6d.svg",i=e+"53f0bab7ec2e970778f9.svg",u=e+"d73f076c46eb5467f5fc.svg";document.getElementById("profile__avatar-logo").src=u,document.getElementById("close__icon-avatar").src=s;const m=document.getElementById("profile__avatar");document.getElementById("header__logo").src=d,document.getElementById("profile__logo").src=c,document.getElementById("profile__logo-plus").src=l,document.getElementById("close__icon").src=s,document.getElementById("close__icon-cards").src=s,document.getElementById("close__icon-preview").src=i,document.getElementById("close__icon-delete").src=i;const _=document.querySelector("#media-template"),h=document.querySelectorAll(".modal"),v=document.querySelector("#modal-edit"),f=document.querySelector(".modal__input_type_description"),p=document.querySelector("#modal-edit-delete"),y=document.getElementById("form-delete"),b=document.querySelector(".modal__input_type_name"),S=document.forms["profile-form"],g=document.querySelector("#modal-edit-card"),E=document.querySelector("#form-card"),q=document.querySelector("#modal__preview"),C=(document.querySelector(".modal__close-btn_type_preview"),document.querySelector("#form-avatar")),k=document.querySelector(".modal__image"),L=document.querySelector(".modal__caption"),x=document.querySelector(".profile__edit-btn"),I=document.querySelector(".profile__username"),B=document.querySelector(".profile__description"),U=document.querySelector(".profile__avatar"),$=document.querySelector(".profile__container-avatar"),A=document.querySelector("#modal-edit-avatar"),D=document.querySelector(".profile__avatar-btn"),R=document.querySelector("#add-avatar-link-input");console.log(D,A,U,$,R);const T=document.querySelector(".modal__button"),w=document.querySelector("#add-card-link-input"),P=document.querySelector(".media__cards"),N=document.querySelector("#add-card-caption-input"),O=document.querySelector(".profile__buttom");let j=null,F=null,J=null;const H=document.querySelector(".modal__button-delete"),z=document.querySelector(".modal__button-cancel"),M=document.querySelector(".modal__button-avatar"),G=new class{constructor(e){this.options=e,this.baseUrl=e.baseUrl,this.headers=e.headers}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._handleResponse)}addLikedCard(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._handleResponse)}removeLikeCard(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._handleResponse)}updateAvatar(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._handleResponse)}updateUserInfo(e){let{name:t,about:n}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:n})}).then(this._handleResponse)}loadingCards(e){let{name:t,link:n}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:n})}).then(this._handleResponse)}removeCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._handleResponse)}getAllData(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"c8225591-fba4-4b45-b151-2e1ffac6d30d","Content-Type":"application/json"}});function K(e){const t=_.content.querySelector(".card").cloneNode(!0),n=t.querySelector(".card__description"),r=t.querySelector(".card__like-btn"),o=t.querySelector(".card__image"),a=t.querySelector(".card__delete-btn");return n.textContent=e.name,o.src=e.link,o.alt=e.name,r.addEventListener("click",(()=>{r.classList.contains("card__like-btn_liked")?G.removeLikeCard(e._id).then((()=>{r.classList.remove("card__like-btn_liked")})).catch((e=>{console.error("failed to remove like:",e)})):G.addLikedCard(e._id).then((()=>{r.classList.add("card__like-btn_liked")})).catch((e=>{console.error("failed to add like:",e)})),r.classList.toggle("card__like-btn_liked")})),a.addEventListener("click",(()=>{j=t,F=e._id,V(p)})),o.addEventListener("click",(()=>{k.src=e.link,k.alt=e.name,L.textContent=e.name,V(q)})),t}function Q(e){if(e.preventDefault(),console.log("Deleting card:",F,j),!F||!j)return;const t=H.textContent;H.textContent="Deleting...",G.removeCard(F).then((()=>{j&&(H.textContent=t,j.remove()),j=null,F=null})).catch((e=>{console.error("Failed to delete card:",e)})).finally((()=>{setTimeout((()=>{W(p)}),100)}))}function V(e){e.classList.add("modal_opened"),document.addEventListener("keydown",Y)}function W(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",Y)}G.getInitialCards().then((e=>{e.forEach((e=>{const t=K(e);P.prepend(t)}))})).catch((e=>{console.error(e)})),G.getAllData().then((e=>{let[t,n]=e;J=n._id,I.textContent=n.name,B.textContent=n.about,m.src=n.avatar,m.alt=n.name})).catch((e=>{console.error(e)})),$.addEventListener("mouseenter",(()=>{D.classList.add("profile_avatar-index")})),$.addEventListener("mouseleave",(()=>{D.classList.remove("profile_avatar-index")})),D.addEventListener("click",(()=>{V(A)})),M.addEventListener("click",(function(e){e.preventDefault();const n=M.textContent;M.textContent="Saving...",G.updateAvatar(R.value).then((e=>{o(M,t),U.src=e.avatar,U.alt=e.name,W(A)})).catch((e=>{console.error("Error updating avatar:",e)})).finally((()=>{C.reset(),M.textContent=n}))}));const X=document.querySelector(".modal__button-profile");function Y(e){"Escape"===e.key&&W(document.querySelector(".modal_opened"))}h.forEach((e=>{e.addEventListener("click",(t=>{t.target===e&&W(e)}))})),document.querySelectorAll(".modal__close-btn").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>W(t)))})),x.addEventListener("click",(()=>{var e,r,a;b.value=I.textContent,f.value=B.textContent,e=S,r=T,a=t,[b,f].forEach((t=>{n(e,t,a)})),o(r,a),V(v)})),y.addEventListener("submit",Q),S.addEventListener("submit",(function(e){e.preventDefault();const t=T.textContent;X.textContent="Saving...";const n=b.value,r=f.value;G.updateUserInfo({name:n,about:r}).then((e=>{I.textContent=e.name,B.textContent=e.about,X.textContent=t})).catch((e=>{console.error("Failed to update user info:",e)})).finally((()=>{setTimeout((()=>{W(v)}),100)}))})),E.addEventListener("submit",(function(e){e.preventDefault();const n=N.value,r=w.value,a=e.submitter.textContent;e.submitter.textContent="Saving...",G.loadingCards({name:n,link:r}).then((n=>{const r=K(n);P.prepend(r),o(e.submitter,t),E.reset()})).catch((e=>{console.error("Failed to load card:",e)})).finally((()=>{e.submitter.textContent=a,W(g)}))})),O.addEventListener("click",(()=>{V(g)})),z.addEventListener("click",(()=>W(p))),p.addEventListener("submit",Q),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNyQmpCLE1BQU1rRSxJQUNMLE1BQU0xQyxFQUFlRixFQUFnQjRDLEdBQ3JDMUYsRUFBVTJFLFFBQVEzQixHQUVsQmxHLEVBQWNrSCxFQUFJeUIsVUFBV3BLLEdBRTdCNEQsRUFBZStGLE9BQU8sSUFFdkJ0QixPQUFPQyxJQUNONUgsUUFBUTZILE1BQU0sdUJBQXdCRCxFQUFJLElBRTNDUSxTQUFRLEtBQ1BILEVBQUl5QixVQUFVbkosWUFBYzRILEVBQzVCRyxFQUFXckYsRUFBYyxHQUUvQixJQW9EQWtCLEVBQW9CMUMsaUJBQWlCLFNBQVMsS0FDNUNzRyxFQUFVOUUsRUFBYyxJQUUxQnVCLEVBQXFCL0MsaUJBQWlCLFNBQVMsSUFBTTZHLEVBQVcxRixLQUVoRUEsRUFBWW5CLGlCQUFpQixTQUFVdUcsR0FFdkM5RyxFQUFpQjVCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvQVBJLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvclwiLFxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JFbCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yRWwudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc29sZS5sb2coXCJJbnB1dCBJRDpcIiwgaW5wdXRFbGVtZW50LmlkKTtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xufTtcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykge1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn1cblxuY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xuICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIGNvbmZpZ1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcbiAgfSk7XG59O1xuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG5cbmV4cG9ydCB7IGRpc2FibGVCdXR0b24sIHJlc2V0VmFsaWRhdGlvbiwgc2V0dGluZ3MsIGVuYWJsZVZhbGlkYXRpb24gfTtcbiIsImltcG9ydCB7IGRpc2FibGVCdXR0b24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCB7IHJlc2V0VmFsaWRhdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IGF2YXRhclNyYyBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcbmltcG9ydCBoZWFkZXJMb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvc3BvdHMuc3ZnXCI7XG5pbXBvcnQgcHJvZmlsZUxvZ29TcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwuc3ZnXCI7XG5pbXBvcnQgcHJvZmlsZUxvZ29QbHVzU3JjIGZyb20gXCIuLi9pbWFnZXMvUGx1cy5zdmdcIjtcbmltcG9ydCBjbG9zZUljb25TcmMgZnJvbSBcIi4uL2ltYWdlcy9CbGFja1guc3ZnXCI7XG5pbXBvcnQgY2xvc2VJY29uUHJldmlld1NyYyBmcm9tIFwiLi4vaW1hZ2VzL0Nsb3NlLWljb24td2hpdGUuc3ZnXCI7XG5pbXBvcnQgd2hpdGVQZW5jaWxTcmMgZnJvbSBcIi4uL2ltYWdlcy93aGl0ZVBlbmNpbC5zdmdcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3NjcmlwdHMvQVBJLmpzXCI7XG5cbmNvbnN0IHByb2ZpbGVBdmF0YXJCdG5Mb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlX19hdmF0YXItbG9nb1wiKTtcbnByb2ZpbGVBdmF0YXJCdG5Mb2dvLnNyYyA9IHdoaXRlUGVuY2lsU3JjO1xuXG5jb25zdCBwcm9maWxlQXZhdGFyQnRuQ2xvc2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlX19pY29uLWF2YXRhclwiKTtcbnByb2ZpbGVBdmF0YXJCdG5DbG9zZS5zcmMgPSBjbG9zZUljb25TcmM7XG5cbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVfX2F2YXRhclwiKTtcblxuY29uc3QgaGVhZGVyTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVhZGVyX19sb2dvXCIpO1xuaGVhZGVyTG9nby5zcmMgPSBoZWFkZXJMb2dvU3JjO1xuXG5jb25zdCBwcm9maWxlTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZV9fbG9nb1wiKTtcbnByb2ZpbGVMb2dvLnNyYyA9IHByb2ZpbGVMb2dvU3JjO1xuXG5jb25zdCBwcm9maWxlTG9nb1BsdXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVfX2xvZ28tcGx1c1wiKTtcbnByb2ZpbGVMb2dvUGx1cy5zcmMgPSBwcm9maWxlTG9nb1BsdXNTcmM7XG5cbmNvbnN0IGNsb3NlSWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb25cIik7XG5jbG9zZUljb24uc3JjID0gY2xvc2VJY29uU3JjO1xuXG5jb25zdCBjbG9zZUljb25jYXJkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb24tY2FyZHNcIik7XG5jbG9zZUljb25jYXJkcy5zcmMgPSBjbG9zZUljb25TcmM7XG5cbmNvbnN0IGNsb3NlSWNvblByZXZpZXcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlX19pY29uLXByZXZpZXdcIik7XG5jbG9zZUljb25QcmV2aWV3LnNyYyA9IGNsb3NlSWNvblByZXZpZXdTcmM7XG5cbmNvbnN0IGNsb3NlSWNvbkRlbGV0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VfX2ljb24tZGVsZXRlXCIpO1xuY2xvc2VJY29uRGVsZXRlLnNyYyA9IGNsb3NlSWNvblByZXZpZXdTcmM7XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiVmFsIHRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5dO1xuXG4vL0dFVFxuXG4vLyBUZW1wbGF0ZVxuY29uc3QgY2FyZHNUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbWVkaWEtdGVtcGxhdGVcIik7XG5cbi8vIE1vZGFsXG5jb25zdCBhbGxNb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xuY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0XCIpO1xuY29uc3QgZGVzY3JpcHRpb25UZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfZGVzY3JpcHRpb25cIlxuKTtcbmNvbnN0IG1vZGFsRGVsZXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0LWRlbGV0ZVwiKTtcbmNvbnN0IGZvcm1EZWxldGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvcm0tZGVsZXRlXCIpO1xuXG5jb25zdCBuYW1lVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XG5jb25zdCBtb2RhbEFkZENhcmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0LWNhcmRcIik7XG5jb25zdCBtb2RhbENhcmRzRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1jYXJkXCIpO1xuY29uc3QgbW9kYWxQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9fcHJldmlld1wiKTtcbmNvbnN0IG1vZGFsQ2FyZENsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ0bl90eXBlX3ByZXZpZXdcIlxuKTtcbmNvbnN0IG1vZGFsQXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1hdmF0YXJcIik7XG5jb25zdCBtb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBtb2RhbENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vL3Byb2ZpbGVcbmNvbnN0IHByb2ZpbGVPcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX191c2VybmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlQXZhdGFyTG9nbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhckxvZ29Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19jb250YWluZXItYXZhdGFyXCJcbik7XG5jb25zdCBwcm9maWxlQXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWVkaXQtYXZhdGFyXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWF2YXRhci1saW5rLWlucHV0XCIpO1xuY29uc29sZS5sb2coXG4gIHByb2ZpbGVBdmF0YXJCdG4sXG4gIHByb2ZpbGVBdmF0YXJNb2RhbCxcbiAgcHJvZmlsZUF2YXRhckxvZ28sXG4gIHByb2ZpbGVBdmF0YXJMb2dvQ29udGFpbmVyLFxuICBwcm9maWxlQXZhdGFySW5wdXRcbik7XG5cbi8vIENhcmRzXG5cbmNvbnN0IGNhcmRTdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG5jb25zdCBsaW5rVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVkaWFfX2NhcmRzXCIpO1xuY29uc3QgY2FwdGlvblRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWNhcHRpb24taW5wdXRcIik7XG5jb25zdCBjYXJkTW9kYWxPcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19idXR0b21cIik7XG5sZXQgc2VsZWN0ZWRDYXJkID0gbnVsbDtcbmxldCBzZWxlY3RlZENhcmRJZCA9IG51bGw7XG5sZXQgY3VycmVudFVzZXJJZCA9IG51bGw7XG4vL2J1dHRvblxuY29uc3QgbW9kYWxEZWxldGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b24tZGVsZXRlXCIpO1xuY29uc3QgbW9kYWxEZWxldGVDYW5jZWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b24tY2FuY2VsXCIpO1xuY29uc3QgbW9kYWxBdmF0YXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b24tYXZhdGFyXCIpO1xuXG4vLyBBcGlcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImM4MjI1NTkxLWZiYTQtNGI0NS1iMTUxLTJlMWZmYWM2ZDMwZFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmFwaVxuICAuZ2V0SW5pdGlhbENhcmRzKClcbiAgLnRoZW4oKHJlcykgPT4ge1xuICAgIHJlcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBjYXJkc0VsZW1lbnQgPSBnZXRDYXJkc0VsZW1lbnQoaXRlbSk7XG4gICAgICBjYXJkc0xpc3QucHJlcGVuZChjYXJkc0VsZW1lbnQpO1xuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgfSk7XG5cbmFwaVxuICAuZ2V0QWxsRGF0YSgpXG4gIC50aGVuKChbY2FyZHNEYXRhLCB1c2Vyc0RhdGFdKSA9PiB7XG4gICAgY3VycmVudFVzZXJJZCA9IHVzZXJzRGF0YS5faWQ7XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2Vyc0RhdGEubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2Vyc0RhdGEuYWJvdXQ7XG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSB1c2Vyc0RhdGEuYXZhdGFyO1xuICAgIHByb2ZpbGVBdmF0YXIuYWx0ID0gdXNlcnNEYXRhLm5hbWU7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcblxuLy8gR2V0IENhcmRzXG5mdW5jdGlvbiBnZXRDYXJkc0VsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkc0VsZW1lbnQgPSBjYXJkc1RlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICBjb25zdCBjYXJkc05hbWUgPSBjYXJkc0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZXNjcmlwdGlvblwiKTtcbiAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkc0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcbiAgY29uc3QgY2FyZHNJbWFnZSA9IGNhcmRzRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBjYXJkRGVsZXRlQnRuID0gY2FyZHNFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcblxuICBjYXJkc05hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIGNhcmRzSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICBjYXJkc0ltYWdlLmFsdCA9IGRhdGEubmFtZTtcblxuICAvL2NhcmQgbGlrZVxuICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNvbnN0IGlzTGlrZWQgPSBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcbiAgICBpZiAoaXNMaWtlZCkge1xuICAgICAgYXBpXG4gICAgICAgIC5yZW1vdmVMaWtlQ2FyZChkYXRhLl9pZClcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZmFpbGVkIHRvIHJlbW92ZSBsaWtlOlwiLCBlcnIpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXBpXG4gICAgICAgIC5hZGRMaWtlZENhcmQoZGF0YS5faWQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcImZhaWxlZCB0byBhZGQgbGlrZTpcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcbiAgfSk7XG5cbiAgLy9jYXJkIGRlbGV0ZVxuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgc2VsZWN0ZWRDYXJkID0gY2FyZHNFbGVtZW50O1xuICAgIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XG4gICAgb3Blbk1vZGFsKG1vZGFsRGVsZXRlKTtcbiAgfSk7XG5cbiAgLy9jYXJkIHByZXZpZXdcbiAgY2FyZHNJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIG1vZGFsSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIG1vZGFsSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIG1vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBvcGVuTW9kYWwobW9kYWxQcmV2aWV3KTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRzRWxlbWVudDtcbn1cblxuLy9Nb2RhbCBhdmF0YXJcbnByb2ZpbGVBdmF0YXJMb2dvQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsICgpID0+IHtcbiAgcHJvZmlsZUF2YXRhckJ0bi5jbGFzc0xpc3QuYWRkKFwicHJvZmlsZV9hdmF0YXItaW5kZXhcIik7XG59KTtcblxucHJvZmlsZUF2YXRhckxvZ29Db250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKCkgPT4ge1xuICBwcm9maWxlQXZhdGFyQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJwcm9maWxlX2F2YXRhci1pbmRleFwiKTtcbn0pO1xuXG5wcm9maWxlQXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChwcm9maWxlQXZhdGFyTW9kYWwpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gbW9kYWxBdmF0YXJCdG4udGV4dENvbnRlbnQ7XG4gIG1vZGFsQXZhdGFyQnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcblxuICBhcGlcbiAgICAudXBkYXRlQXZhdGFyKHByb2ZpbGVBdmF0YXJJbnB1dC52YWx1ZSlcbiAgICAudGhlbigodXBkYXRlZFVzZXIpID0+IHtcbiAgICAgIGRpc2FibGVCdXR0b24obW9kYWxBdmF0YXJCdG4sIHNldHRpbmdzKTtcbiAgICAgIHByb2ZpbGVBdmF0YXJMb2dvLnNyYyA9IHVwZGF0ZWRVc2VyLmF2YXRhcjtcbiAgICAgIHByb2ZpbGVBdmF0YXJMb2dvLmFsdCA9IHVwZGF0ZWRVc2VyLm5hbWU7XG5cbiAgICAgIGNsb3NlUG9wdXAocHJvZmlsZUF2YXRhck1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgYXZhdGFyOlwiLCBlcnIpO1xuICAgICAgLy8gUHVlZGVzIG1vc3RyYXIgdW4gbWVuc2FqZSBkZSBlcnJvciBlbiBsYSBVSSBzaSBsbyBkZXNlYXNcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIG1vZGFsQXZhdGFyRm9ybS5yZXNldCgpO1xuICAgICAgbW9kYWxBdmF0YXJCdG4udGV4dENvbnRlbnQgPSBvcmlnaW5hbFRleHQ7XG4gICAgfSk7XG59XG5tb2RhbEF2YXRhckJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQXZhdGFyU3VibWl0KTtcblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zb2xlLmxvZyhcIkRlbGV0aW5nIGNhcmQ6XCIsIHNlbGVjdGVkQ2FyZElkLCBzZWxlY3RlZENhcmQpO1xuICBpZiAoIXNlbGVjdGVkQ2FyZElkIHx8ICFzZWxlY3RlZENhcmQpIHJldHVybjtcblxuICBjb25zdCBvcmlnaW5hbFRleHQgPSBtb2RhbERlbGV0ZUJ0bi50ZXh0Q29udGVudDtcbiAgbW9kYWxEZWxldGVCdG4udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XG5cbiAgYXBpXG4gICAgLnJlbW92ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgaWYgKHNlbGVjdGVkQ2FyZCkge1xuICAgICAgICBtb2RhbERlbGV0ZUJ0bi50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcbiAgICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgc2VsZWN0ZWRDYXJkID0gbnVsbDtcbiAgICAgIHNlbGVjdGVkQ2FyZElkID0gbnVsbDtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGRlbGV0ZSBjYXJkOlwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNsb3NlUG9wdXAobW9kYWxEZWxldGUpO1xuICAgICAgfSwgMTAwKTtcbiAgICB9KTtcbn1cblxuLy8gT3BlbiBNb2RhbFxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIG1vZGFsQ2xvc2VPbkVzYyk7XG59XG5cbi8vIENsb3NlIE1vZGFsXG5cbmZ1bmN0aW9uIGNsb3NlUG9wdXAocG9wdXApIHtcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgbW9kYWxDbG9zZU9uRXNjKTtcbn1cblxuY29uc3QgbW9kYWxTdWJtaXRCdG5Qcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uLXByb2ZpbGVcIik7XG5cbi8vIFByb2ZpbGUgRm9ybSBTdWJtaXRcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gY2FyZFN1Ym1pdEJ0bi50ZXh0Q29udGVudDtcbiAgbW9kYWxTdWJtaXRCdG5Qcm9maWxlLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgY29uc3QgbmFtZSA9IG5hbWVUZXh0LnZhbHVlO1xuICBjb25zdCBhYm91dCA9IGRlc2NyaXB0aW9uVGV4dC52YWx1ZTtcblxuICBhcGlcbiAgICAudXBkYXRlVXNlckluZm8oeyBuYW1lLCBhYm91dCB9KVxuICAgIC50aGVuKCh1cGRhdGVkVXNlcikgPT4ge1xuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1cGRhdGVkVXNlci5uYW1lO1xuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXBkYXRlZFVzZXIuYWJvdXQ7XG4gICAgICBtb2RhbFN1Ym1pdEJ0blByb2ZpbGUudGV4dENvbnRlbnQgPSBvcmlnaW5hbFRleHQ7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgdXNlciBpbmZvOlwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNsb3NlUG9wdXAocHJvZmlsZU1vZGFsKTtcbiAgICAgIH0sIDEwMCk7XG4gICAgfSk7XG59XG5cbi8vIENhcmQgRm9ybSBTdWJtaXRcbmZ1bmN0aW9uIGhhbmRsZXJDYXJkRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IG5hbWUgPSBjYXB0aW9uVGV4dC52YWx1ZTtcbiAgY29uc3QgbGluayA9IGxpbmtUZXh0LnZhbHVlO1xuICBjb25zdCBvcmlnaW5hbFRleHQgPSBldnQuc3VibWl0dGVyLnRleHRDb250ZW50O1xuICBldnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcblxuICBhcGlcbiAgICAubG9hZGluZ0NhcmRzKHsgbmFtZSwgbGluayB9KVxuICAgIC50aGVuKChuZXdDYXJkKSA9PiB7XG4gICAgICBjb25zdCBjYXJkc0VsZW1lbnQgPSBnZXRDYXJkc0VsZW1lbnQobmV3Q2FyZCk7XG4gICAgICBjYXJkc0xpc3QucHJlcGVuZChjYXJkc0VsZW1lbnQpO1xuXG4gICAgICBkaXNhYmxlQnV0dG9uKGV2dC5zdWJtaXR0ZXIsIHNldHRpbmdzKTtcblxuICAgICAgbW9kYWxDYXJkc0Zvcm0ucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvYWQgY2FyZDpcIiwgZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGV2dC5zdWJtaXR0ZXIudGV4dENvbnRlbnQgPSBvcmlnaW5hbFRleHQ7XG4gICAgICBjbG9zZVBvcHVwKG1vZGFsQWRkQ2FyZHMpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gY2xvc2VQb3B1cE91dHNpZGUobW9kYWxzKSB7XG4gIG1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChldmVudC50YXJnZXQgPT09IG1vZGFsKSB7XG4gICAgICAgIGNsb3NlUG9wdXAobW9kYWwpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cbmNsb3NlUG9wdXBPdXRzaWRlKGFsbE1vZGFscyk7XG5cbi8vRm9yIEVhY2ggY2FyZHNcblxuLy8gQ2xvc2UgTW9kYWxcblxuY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gIC8vIEZpbmQgdGhlIGNsb3Nlc3QgcG9wdXAgb25seSBvbmNlXG4gIGNvbnN0IHBvcHVwID0gYnV0dG9uLmNsb3Nlc3QoXCIubW9kYWxcIik7XG4gIC8vIFNldCB0aGUgbGlzdGVuZXJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZVBvcHVwKHBvcHVwKSk7XG59KTtcblxuLy9rZXlQcmVzc1xuZnVuY3Rpb24gbW9kYWxDbG9zZU9uRXNjKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgY2xvc2VQb3B1cChvcGVuZWRQb3B1cCk7XG4gIH1cbn1cbi8vIE9wZW4gTW9kYWxcbnByb2ZpbGVPcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG5hbWVUZXh0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XG4gIGRlc2NyaXB0aW9uVGV4dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgcmVzZXRWYWxpZGF0aW9uKFxuICAgIHByb2ZpbGVGb3JtLFxuICAgIFtuYW1lVGV4dCwgZGVzY3JpcHRpb25UZXh0XSxcbiAgICBjYXJkU3VibWl0QnRuLFxuICAgIHNldHRpbmdzXG4gICk7XG4gIG9wZW5Nb2RhbChwcm9maWxlTW9kYWwpO1xufSk7XG4vLyBGb3JtIGRlbGV0ZVxuZm9ybURlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XG4vLyBQcm9maWxlIGZvcm0gU3VibWl0XG5wcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcblxuLy8gQ2FyZCBGb3JtIHN1Ym1pdFxubW9kYWxDYXJkc0Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVyQ2FyZEZvcm1TdWJtaXQpO1xuXG5jYXJkTW9kYWxPcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChtb2RhbEFkZENhcmRzKTtcbn0pO1xubW9kYWxEZWxldGVDYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlUG9wdXAobW9kYWxEZWxldGUpKTtcblxubW9kYWxEZWxldGUuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIHRoaXMuYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcbiAgICB0aGlzLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBfaGFuZGxlUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cblxuICBhZGRMaWtlZENhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgYWJvdXQ6IGFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XG4gIH1cblxuICBsb2FkaW5nQ2FyZHMoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0QWxsRGF0YSgpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNvbmZpZyIsImNvbnNvbGUiLCJsb2ciLCJpZCIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0ZXh0Q29udGVudCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWxlbWVudCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsImVycm9yRWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImdldEVsZW1lbnRCeUlkIiwic3JjIiwid2hpdGVQZW5jaWxTcmMiLCJjbG9zZUljb25TcmMiLCJwcm9maWxlQXZhdGFyIiwiaGVhZGVyTG9nb1NyYyIsInByb2ZpbGVMb2dvU3JjIiwicHJvZmlsZUxvZ29QbHVzU3JjIiwiY2xvc2VJY29uUHJldmlld1NyYyIsImNhcmRzVGVtcGxhdGUiLCJhbGxNb2RhbHMiLCJwcm9maWxlTW9kYWwiLCJkZXNjcmlwdGlvblRleHQiLCJtb2RhbERlbGV0ZSIsImZvcm1EZWxldGUiLCJuYW1lVGV4dCIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJtb2RhbEFkZENhcmRzIiwibW9kYWxDYXJkc0Zvcm0iLCJtb2RhbFByZXZpZXciLCJtb2RhbEF2YXRhckZvcm0iLCJtb2RhbEltYWdlIiwibW9kYWxDYXB0aW9uIiwicHJvZmlsZU9wZW5CdXR0b24iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVBdmF0YXJMb2dvIiwicHJvZmlsZUF2YXRhckxvZ29Db250YWluZXIiLCJwcm9maWxlQXZhdGFyTW9kYWwiLCJwcm9maWxlQXZhdGFyQnRuIiwicHJvZmlsZUF2YXRhcklucHV0IiwiY2FyZFN1Ym1pdEJ0biIsImxpbmtUZXh0IiwiY2FyZHNMaXN0IiwiY2FwdGlvblRleHQiLCJjYXJkTW9kYWxPcGVuQnV0dG9uIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJjdXJyZW50VXNlcklkIiwibW9kYWxEZWxldGVCdG4iLCJtb2RhbERlbGV0ZUNhbmNlbEJ0biIsIm1vZGFsQXZhdGFyQnRuIiwiYXBpIiwiY29uc3RydWN0b3IiLCJvcHRpb25zIiwidGhpcyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsImFkZExpa2VkQ2FyZCIsImNhcmRJZCIsIm1ldGhvZCIsInJlbW92ZUxpa2VDYXJkIiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJnZXRVc2VySW5mbyIsInVwZGF0ZVVzZXJJbmZvIiwiX3JlZiIsIm5hbWUiLCJhYm91dCIsImxvYWRpbmdDYXJkcyIsIl9yZWYyIiwibGluayIsInJlbW92ZUNhcmQiLCJnZXRBbGxEYXRhIiwiYWxsIiwiYXV0aG9yaXphdGlvbiIsImdldENhcmRzRWxlbWVudCIsImRhdGEiLCJjYXJkc0VsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZHNOYW1lIiwiY2FyZExpa2VCdG4iLCJjYXJkc0ltYWdlIiwiY2FyZERlbGV0ZUJ0biIsImFsdCIsImNvbnRhaW5zIiwiX2lkIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsInRvZ2dsZSIsIm9wZW5Nb2RhbCIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwib3JpZ2luYWxUZXh0IiwiZmluYWxseSIsInNldFRpbWVvdXQiLCJjbG9zZVBvcHVwIiwibW9kYWwiLCJtb2RhbENsb3NlT25Fc2MiLCJwb3B1cCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJpdGVtIiwicHJlcGVuZCIsImNhcmRzRGF0YSIsInVzZXJzRGF0YSIsInZhbHVlIiwidXBkYXRlZFVzZXIiLCJyZXNldCIsIm1vZGFsU3VibWl0QnRuUHJvZmlsZSIsImtleSIsImV2ZW50IiwidGFyZ2V0IiwiYnV0dG9uIiwiY2xvc2VzdCIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0Iiwic3VibWl0dGVyIiwibmV3Q2FyZCJdLCJzb3VyY2VSb290IjoiIn0=